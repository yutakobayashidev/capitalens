"use strict";(self.webpackChunkcapitalens=self.webpackChunkcapitalens||[]).push([[978],{"./src/components/chatbot/chatbot.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,default:()=>chatbot_stories});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),member_card=__webpack_require__("./src/components/member-card/member-card.tsx"),population=__webpack_require__("./src/components/population/population.tsx"),dist=__webpack_require__("./node_modules/@xpadev-net/designsystem-icons/dist/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),index_esm=__webpack_require__("./node_modules/react-icons/si/index.esm.js"),react_markdown=__webpack_require__("./node_modules/react-markdown/lib/react-markdown.js"),__jsx=react.createElement;function MessageItem(_ref){var _user$image,_user$name,countries=_ref.countries,data=_ref.data,message=_ref.message,user=_ref.user;return __jsx(react.Fragment,null,__jsx("div",{className:"flex items-start"},user&&"user"===message.role?__jsx("img",{src:null!==(_user$image=user.image)&&void 0!==_user$image?_user$image:"/noimage.png",alt:null!==(_user$name=user.name)&&void 0!==_user$name?_user$name:"不明",className:"h-8 w-8 rounded-md border shadow"}):__jsx("div",{className:classnames_default()("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border shadow","user"===message.role?"bg-gray-100":"bg-black")},"user"===message.role?__jsx(dist.MeOutlinedIcon,{width:"1em",height:"1em",fill:"currentColor",className:"h-4 w-4"}):__jsx(index_esm.Cp6,{className:"h-4 w-4 text-white"})),__jsx(react_markdown.D,{className:"prose prose-neutral prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-img:rounded-lg prose-img:shadow ml-4 max-w-none flex-1 space-y-2 overflow-hidden px-1"},message.content)),__jsx("div",{className:"mt-5"},"get_member_info"===(null==data?void 0:data.type)?__jsx(member_card.Z,{member:data.body}):"get_population"===(null==data?void 0:data.type)?__jsx(population.Z,{countries,transformedData:data.body}):"error"===(null==data?void 0:data.type)&&__jsx("span",{className:"text-sm text-red-400"},"⚠ ",data.body)))}MessageItem.__docgenInfo={description:"",methods:[],displayName:"MessageItem",props:{countries:{required:!0,tsType:{name:"Array",elements:[{name:"Country"}],raw:"Country[]"},description:""},data:{required:!0,tsType:{name:"any"},description:""},message:{required:!0,tsType:{name:"Message"},description:""},user:{required:!0,tsType:{name:'Session["user"]',raw:'Session["user"]'},description:""}}};try{Message.displayName="Message",Message.__docgenInfo={description:"",displayName:"Message",props:{countries:{defaultValue:null,description:"",name:"countries",required:!0,type:{name:"Country[]"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"any"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"Message"}},user:{defaultValue:null,description:"",name:"user",required:!0,type:{name:"{ name?: string | null | undefined; email?: string | null | undefined; image?: string | null | undefined; } | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/app/(chat)/chat/Message.tsx#Message"]={docgenInfo:Message.__docgenInfo,name:"Message",path:"src/app/(chat)/chat/Message.tsx#Message"})}catch(__react_docgen_typescript_loader_error){}var _Basic$parameters,_Basic$parameters2,placeholderAtom=(0,__webpack_require__("./node_modules/jotai/esm/vanilla.mjs").cn)("質問を入力してください"),react_dist=__webpack_require__("./node_modules/ai/react/dist/index.mjs"),AnimatePresence=__webpack_require__("./node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs"),motion=__webpack_require__("./node_modules/framer-motion/dist/es/render/dom/motion.mjs"),esm_react=__webpack_require__("./node_modules/jotai/esm/react.mjs"),fa_index_esm=__webpack_require__("./node_modules/react-icons/fa/index.esm.js"),io_index_esm=__webpack_require__("./node_modules/react-icons/io/index.esm.js"),sonner_dist=__webpack_require__("./node_modules/sonner/dist/index.mjs"),chatbot_jsx=react.createElement;function Chatbot(_ref){var countries=_ref.countries,user=_ref.user,_useState=(0,react.useState)(!1),isOpen=_useState[0],setIsOpen=_useState[1],_useAtom=(0,esm_react.KO)(placeholderAtom),placeholder=(0,slicedToArray.Z)(_useAtom,1)[0],_useChat=(0,react_dist.R)({api:"/api/chat",onResponse:function onResponse(response){429!==response.status||sonner_dist.A.error("利用制限を超えました。時間を開けてお試しください。")}}),data=_useChat.data,handleInputChange=_useChat.handleInputChange,handleSubmit=_useChat.handleSubmit,input=_useChat.input,isLoading=_useChat.isLoading,messages=_useChat.messages,setInput=_useChat.setInput;return chatbot_jsx("div",{className:"fixed bottom-[0] right-[30px] hidden w-[380px] rounded-t-2xl border border-gray-200 bg-white px-5 py-3 shadow-2xl md:block"},chatbot_jsx("div",{className:"flex items-center justify-between"},chatbot_jsx("h2",{className:"flex items-center text-xl font-bold"},chatbot_jsx(fa_index_esm.hWE,{className:"mr-2 text-[#9d34da]"}),"AIに質問する"),chatbot_jsx("button",{onClick:function handleClick(){setIsOpen(!isOpen)}},chatbot_jsx(isOpen?dist.ArrowDownIcon:dist.ArrowUpIcon,{width:"1em",height:"1em",fill:"currentColor",className:"text-xl text-gray-700"}))),chatbot_jsx(AnimatePresence.M,null,isOpen&&chatbot_jsx(motion.E.div,{className:"mt-3 flex flex-col",style:{maxHeight:"400px"},variants:{closed:{height:"0"},open:{height:"400px"}},initial:"closed",animate:"open",exit:"closed",transition:{duration:.3}},chatbot_jsx("div",{className:"grow overflow-y-auto"},messages.length?messages.map((function(message,i){var correspondingData=data?data.find((function(d){return d.index===i})):null;return chatbot_jsx("div",{key:i,className:"mb-5"},chatbot_jsx(MessageItem,{countries,message,user,data:correspondingData}))})):chatbot_jsx("div",{className:"rounded-lg border bg-gray-50 px-4 py-3 text-sm text-gray-500"},chatbot_jsx("p",{className:"mb-2"},chatbot_jsx("span",{className:"text-base"},"💡")," ","AIと対話し、様々な視点から効率的に情報を収集できます"),chatbot_jsx("span",{className:"text-xs"},"Tip: Tabキーでプレスホルダーの内容が自動的に入力されます"))),chatbot_jsx("form",{onSubmit:handleSubmit,className:"mt-3 w-full rounded-md bg-gray-100 px-4 py-1.5"},chatbot_jsx("input",{required:!0,value:input,onChange:handleInputChange,onKeyDown:function onKeyDown(e){"Tab"===e.key&&(e.preventDefault(),setInput(placeholder))},className:"w-full resize-none border-0 bg-transparent p-0 pl-3 pr-10 outline-none focus:ring-0 focus-visible:ring-0 md:pl-0 md:pr-12",placeholder}),chatbot_jsx("button",{type:"submit",disabled:isLoading||""===input,className:"absolute right-7 rounded-md bg-blue-400 p-1 text-white disabled:bg-opacity-0 disabled:text-gray-800"},chatbot_jsx("span",null,chatbot_jsx(io_index_esm.ghy,null)))))))}Chatbot.displayName="Chatbot",Chatbot.__docgenInfo={description:"",methods:[],displayName:"Chatbot",props:{countries:{required:!0,tsType:{name:"Array",elements:[{name:"Country"}],raw:"Country[]"},description:""},user:{required:!0,tsType:{name:'Session["user"]',raw:'Session["user"]'},description:""}}};try{chatbot.displayName="chatbot",chatbot.__docgenInfo={description:"",displayName:"chatbot",props:{countries:{defaultValue:null,description:"",name:"countries",required:!0,type:{name:"Country[]"}},user:{defaultValue:null,description:"",name:"user",required:!0,type:{name:"{ name?: string | null | undefined; email?: string | null | undefined; image?: string | null | undefined; } | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/chatbot/chatbot.tsx#chatbot"]={docgenInfo:chatbot.__docgenInfo,name:"chatbot",path:"src/components/chatbot/chatbot.tsx#chatbot"})}catch(__react_docgen_typescript_loader_error){}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var Basic={};const chatbot_stories={component:Chatbot,parameters:{layout:"fullscreen"}};Basic.parameters=_objectSpread(_objectSpread({},Basic.parameters),{},{docs:_objectSpread(_objectSpread({},null===(_Basic$parameters=Basic.parameters)||void 0===_Basic$parameters?void 0:_Basic$parameters.docs),{},{source:_objectSpread({originalSource:"{}"},null===(_Basic$parameters2=Basic.parameters)||void 0===_Basic$parameters2||null===(_Basic$parameters2=_Basic$parameters2.docs)||void 0===_Basic$parameters2?void 0:_Basic$parameters2.source)})})},"./src/components/member-card/member-card.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>MemberCard});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_src_helper_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/helper/utils.ts"),next_link__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/next/link.js"),next_link__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_2__),react_icons_ai__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-icons/ai/index.esm.js"),react_icons_fa__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-icons/fa/index.esm.js"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function MemberCard(_ref){var _member$image,_member$abstract,member=_ref.member;return __jsx("div",{className:"mb-5 rounded-lg border px-4 pb-2 pt-6"},__jsx("div",{className:"mb-4 md:flex"},__jsx("img",{src:null!==(_member$image=member.image)&&void 0!==_member$image?_member$image:"/noimage.png",className:"mb-3 mr-5 rounded-lg object-cover object-center md:mb-0",alt:member.name}),__jsx("div",null,__jsx("h2",{className:"mb-1 text-2xl font-bold"},member.name),member.group&&__jsx("div",{className:"mb-2 text-gray-500"},member.group.name+"の"+("REPRESENTATIVES"===member.house?"衆議院":"参議院")+"議員"),__jsx("p",{className:"mb-3 line-clamp-4 text-sm text-gray-600"},null!==(_member$abstract=member.abstract)&&void 0!==_member$abstract?_member$abstract:member.description),__jsx("div",{className:"flex flex-wrap items-center gap-y-2"},__jsx(next_link__WEBPACK_IMPORTED_MODULE_2___default(),{href:"/members/".concat(member.id),className:"mr-2 inline-flex items-center rounded-full bg-blue-400 px-3 py-2 text-sm font-semibold text-white"},__jsx(react_icons_fa__WEBPACK_IMPORTED_MODULE_3__.ssk,{className:"mr-2 text-base"}),"詳細"),member.twitter&&__jsx("a",{href:"https://twitter.com/"+member.twitter,className:"mr-2 inline-flex items-center rounded-full bg-gray-900 px-3 py-2 text-sm font-semibold text-white"},__jsx("svg",{"aria-label":"X formerly known as Twitter",fill:"currentColor",className:"mx-auto mr-2 h-4 w-4",viewBox:"0 0 22 20"},__jsx("path",{d:"M16.99 0H20.298L13.071 8.26L21.573 19.5H14.916L9.702 12.683L3.736 19.5H0.426L8.156 10.665L0 0H6.826L11.539 6.231L16.99 0ZM15.829 17.52H17.662L5.83 1.876H3.863L15.829 17.52Z"})),"@",member.twitter),member.website&&__jsx("a",{href:member.website,className:"inline-flex items-center rounded-full bg-gray-400 px-3 py-2 text-sm font-semibold text-white"},__jsx(react_icons_ai__WEBPACK_IMPORTED_MODULE_4__.uFt,{"aria-label":"Web site",className:"mr-2 text-base"}),(0,_src_helper_utils__WEBPACK_IMPORTED_MODULE_1__.ci)(member.website))))),member.abstract&&__jsx("div",{className:"mb-2 text-xs text-gray-500"},member.wikipedia?__jsx("a",{className:"text-primary font-medium hover:underline",href:member.wikipedia},"ウィキペディアの項目"):__jsx("span",{className:"font-medium"},"Wikipediaの項目"),"を",__jsx("a",{className:"text-primary font-medium hover:underline",href:"https://creativecommons.org/licenses/by-sa/3.0/deed.ja"},"Creative Commons Attribution (CC BY-SA 3.0)"),"に基づき二次利用しています。"))}MemberCard.displayName="MemberCard",MemberCard.__docgenInfo={description:"",methods:[],displayName:"MemberCard",props:{member:{required:!0,tsType:{name:"Member"},description:""}}};try{membercard.displayName="membercard",membercard.__docgenInfo={description:"",displayName:"membercard",props:{member:{defaultValue:null,description:"",name:"member",required:!0,type:{name:"Member"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/member-card/member-card.tsx#membercard"]={docgenInfo:membercard.__docgenInfo,name:"membercard",path:"src/components/member-card/member-card.tsx#membercard"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/population/population.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Population});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),recharts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/recharts/es6/component/ResponsiveContainer.js"),recharts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/recharts/es6/chart/LineChart.js"),recharts__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/recharts/es6/cartesian/CartesianGrid.js"),recharts__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/recharts/es6/cartesian/XAxis.js"),recharts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/recharts/es6/cartesian/YAxis.js"),recharts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/recharts/es6/component/Tooltip.js"),recharts__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/recharts/es6/cartesian/Line.js"),console=__webpack_require__("./node_modules/console-browserify/index.js"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function formatJapaneseNumber(num){return num>=1e8?(num/1e8).toFixed(1)+"億":num>=1e4?(num/1e4).toFixed(1)+"万":num.toString()}function CustomTooltip(_ref){var active=_ref.active,label=_ref.label,payload=_ref.payload;return active&&payload&&payload.length?__jsx("div",{className:"custom-tooltip border bg-white p-3"},__jsx("p",{className:"label"},label),__jsx("p",{className:"desc"},"人口: ",formatJapaneseNumber(payload[0].value))):null}function Population(_ref2){var _findCountryByCode,_findCountryByCode2,countries=_ref2.countries,transformedData=_ref2.transformedData;function findCountryByCode(code){return countries.find((function(country){return country.code===code}))}return console.log(transformedData),__jsx("div",{className:"w-full rounded border px-3 py-4"},__jsx("h3",{className:"mb-5 text-lg font-medium text-gray-800"},null===(_findCountryByCode=findCountryByCode(transformedData[0].country_id))||void 0===_findCountryByCode?void 0:_findCountryByCode.emoji," ",null===(_findCountryByCode2=findCountryByCode(transformedData[0].country_id))||void 0===_findCountryByCode2?void 0:_findCountryByCode2.name,"の人口推移"),__jsx(recharts__WEBPACK_IMPORTED_MODULE_1__.h,{width:"100%",height:300},__jsx(recharts__WEBPACK_IMPORTED_MODULE_2__.w,{data:transformedData,margin:{bottom:5,left:20,right:30,top:5}},__jsx(recharts__WEBPACK_IMPORTED_MODULE_3__.q,{strokeDasharray:"3 3"}),__jsx(recharts__WEBPACK_IMPORTED_MODULE_4__.K,{dataKey:"date"}),__jsx(recharts__WEBPACK_IMPORTED_MODULE_5__.B,{tickFormatter:formatJapaneseNumber}),__jsx(recharts__WEBPACK_IMPORTED_MODULE_6__.u,{content:__jsx(CustomTooltip,null)}),__jsx(recharts__WEBPACK_IMPORTED_MODULE_7__.x,{type:"monotone",dataKey:"value",stroke:"#8884d8",activeDot:{r:8}}))),__jsx("span",{className:"text-sm text-gray-500"},"ソース:"," ",__jsx("a",{href:"https://www.worldbank.org/en/home",className:"text-primary"},"世界銀行")))}Population.displayName="Population",Population.__docgenInfo={description:"",methods:[],displayName:"Population",props:{countries:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  name: string;\n  code: string;\n  emoji: string;\n  image: string;\n  unicode: string;\n}",signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"code",value:{name:"string",required:!0}},{key:"emoji",value:{name:"string",required:!0}},{key:"image",value:{name:"string",required:!0}},{key:"unicode",value:{name:"string",required:!0}}]}}],raw:"Country[]"},description:""},transformedData:{required:!0,tsType:{name:"any"},description:""}}};try{population.displayName="population",population.__docgenInfo={description:"",displayName:"population",props:{countries:{defaultValue:null,description:"",name:"countries",required:!0,type:{name:"Country[]"}},transformedData:{defaultValue:null,description:"",name:"transformedData",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/population/population.tsx#population"]={docgenInfo:population.__docgenInfo,name:"population",path:"src/components/population/population.tsx#population"})}catch(__react_docgen_typescript_loader_error){}},"./src/helper/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AF:()=>isKanji,Tk:()=>kanaToHira,ci:()=>getHostFromURL,gO:()=>getFaviconSrcFromHostname,p6:()=>formatDate});__webpack_require__("./node_modules/dayjs/locale/ja.js");var dayjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),dayjs__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(dayjs__WEBPACK_IMPORTED_MODULE_1__),dayjs_plugin_relativeTime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/dayjs/plugin/relativeTime.js"),dayjs_plugin_relativeTime__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(dayjs_plugin_relativeTime__WEBPACK_IMPORTED_MODULE_2__);function getFaviconSrcFromHostname(hostname){return"https://www.google.com/s2/favicons?sz=128&domain=".concat(hostname)}function getHostFromURL(url){return new URL(url).hostname}function formatDate(dateText){var format=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD",date=dayjs__WEBPACK_IMPORTED_MODULE_1___default()(dateText);return Math.abs(date.diff(Date.now(),"month"))<6?date.fromNow():date.format(format)}dayjs__WEBPACK_IMPORTED_MODULE_1___default().locale("ja"),dayjs__WEBPACK_IMPORTED_MODULE_1___default().extend(dayjs_plugin_relativeTime__WEBPACK_IMPORTED_MODULE_2___default());var kanaToHira=function kanaToHira(str){return str.replace(/[\u30a1-\u30f6]/g,(function(match){return String.fromCharCode(match.charCodeAt(0)-96)}))},isKanji=function isKanji(ch){var unicode=ch.charCodeAt(0);return unicode>=19968&&unicode<=40879}}}]);